FULL SEAT-COLORING UPDATE PROMPT (Copy–Paste This Entire Block)

PROMPT START

Update the project to support gender-based seat coloring so users can visually identify whether a booked seat belongs to a male, female, or other passenger.

Apply ALL of the following changes across backend + frontend:

1. Database Update

Add a gender column to the bookings table:

ALTER TABLE bookings
ADD COLUMN gender VARCHAR(16) DEFAULT 'unknown';


If using Prisma, update schema:

model Booking {
  id         Int      @id @default(autoincrement())
  userId     Int
  tripId     Int
  seatNumber String
  totalFare  Float
  createdAt  DateTime @default(now())
  gender     String   @default("unknown")
}


Run migration accordingly.

2. BACKEND — Save and Return Gender Info
A. Booking Creation

In POST /api/bookings, accept gender from request body and store it.

const normalizedGender = (req.body.gender || "unknown").toLowerCase();
const allowed = ["male", "female", "other", "unknown"];
const genderVal = allowed.includes(normalizedGender) ? normalizedGender : "unknown";

const booking = await prisma.booking.create({
  data: {
    userId,
    tripId,
    seatNumber: seats.join(","),
    totalFare,
    gender: genderVal,
    pickupPoint,
    dropPoint,
  },
});

B. Include Gender in Seat Response

Update /api/trips/:id/seats to return gender with each booked seat:

const seats = await prisma.seat.findMany({
  where: { tripId },
  select: {
    id: true,
    seatNumber: true,
    status: true,
    booking: { select: { gender: true } }
  }
});

const mapped = seats.map(s => ({
  seatNumber: s.seatNumber,
  status: s.status,
  gender: s.booking?.gender ?? "unknown"
}));

res.json({ seats: mapped });

3. FRONTEND — Seat Component Coloring

Add class based on gender.

In Seat.tsx:

const gender = (seat.gender || "unknown").toLowerCase();

const classList = [
  "seat",
  seat.status === "booked" ? "seat--booked" : "seat--available",
  seat.status === "booked" ? `seat--${gender}` : ""
].join(" ");

4. CSS — Gender Colors

Add these in your seat stylesheet:

.seat--male {
  background: linear-gradient(135deg, #03A9F4, #007ACC);
  color: white;
}

.seat--female {
  background: linear-gradient(135deg, #F451B2, #D02C90);
  color: white;
}

.seat--other {
  background: linear-gradient(135deg, #888, #555);
  color: white;
}

.seat--unknown {
  background: rgba(255,255,255,0.1);
  color: #ccc;
}

5. FRONTEND — Passenger Details Form Must Send Gender

Add radio buttons:

<label><input type="radio" name="gender" value="male" /> Male</label>
<label><input type="radio" name="gender" value="female" /> Female</label>
<label><input type="radio" name="gender" value="other" /> Other</label>


Send gender in the booking request body.

6. Add Seat Map Legend

Below the seat grid add:

<div className="seat-legend">
  <div><span class="legend male"></span> Male Booked</div>
  <div><span class="legend female"></span> Female Booked</div>
  <div><span class="legend other"></span> Other</div>
  <div><span class="legend available"></span> Available</div>
</div>


And CSS:

.legend {
  width: 16px;
  height: 16px;
  display: inline-block;
  border-radius: 4px;
}
.legend.male { background: #03A9F4; }
.legend.female { background: #F451B2; }
.legend.other { background: #888; }
.legend.available { background: #444; }

ACCEPTANCE CRITERIA

Seat API returns gender.

Booked seats show blue for male, pink for female, gray for other, white for unknown.

Available seats remain unchanged.

Gender selection is required before booking.

Legend appears under seat map.

No existing functionality breaks.

Apply all code updates automatically.

PROMPT END